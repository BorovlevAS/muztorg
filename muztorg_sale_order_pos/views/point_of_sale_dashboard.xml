<?xml version='1.0' encoding='utf-8' ?>
<odoo>
    <record id="view_pos_config_kanban" model="ir.ui.view">
        <field name="name">pos.config.kanban.view</field>
        <field name="model">pos.config</field>
        <field name="inherit_id" ref="point_of_sale.view_pos_config_kanban" />
        <field name="arch" type="xml">
            <xpath expr="//button[@name='open_existing_session_cb'][2]" position="replace">
                <button
                    t-if="_.contains(['opened', 'closing_control'], record.current_session_state.raw_value)"
                    class="btn btn-primary"
                    name="open_existing_session_cb"
                    type="object"
                >
                    Open Active Session
                </button>
            </xpath>
            <button name="open_ui" position="attributes">
                <attribute name="invisible">1</attribute>
            </button>
            <xpath expr="//kanban/templates" position="before">
                <field name="pos_payment_lines_json" invisible="1" />
            </xpath>
            <xpath expr="//field[@name='last_session_closing_cash']/../../.." position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//div[hasclass('o_kanban_card_content')]/div[hasclass('row')]" position="after">
                <div t-if="record.current_session_id" attrs='{"invisible": [("cash_control","=",False)]}'>
                    <t t-set="pos_line_data" t-value="JSON.parse(record.pos_payment_lines_json.raw_value)" />
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th scope="col">Payment type</th>
                                <th scope="col">Amount</th>
                            </tr>
                        </thead>
                        <t t-foreach="pos_line_data" t-as="pos_line">
                            <tr>
                                <td>
                                    <t t-esc="pos_line['name']" />
                                </td>
                                <td style="text-align:right;">
                                    <span t-esc="pos_line['amount']" t-options="{'widget': 'float', 'precision': 2}" />
                                </td>
                            </tr>
                        </t>
                    </table>
                </div>
            </xpath>
        </field>
    </record>
</odoo>
